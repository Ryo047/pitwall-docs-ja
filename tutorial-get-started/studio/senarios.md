# シナリオ
## シナリオとは
<!--　Pitwallの動作設定を記述したものをシナリオと呼びます。-->
各シナリオはフローチャートになっており、各要素をフローチャート内に設定します。例えば、アラートを起因とするシナリオを新規作成する場合、「トリガー」「ルックアップ」「通知先」等の要素でシナリオが構成されます。イベントを受領した際にどこからどのような情報を収集するか、そして収集した情報をどこ宛てに通知するか等を設定します。設定できる要素は、各シナリオタイプにより異なります。複数のアラートで同じデータルックアップが必要な場合は、それらに対して同じシナリオを使用できます。
## シナリオ
シナリオの新規作成と、作成されているシナリオを一覧で表示します。
- シナリオの新規作成：ボタンをクリックすることで、新規シナリオ作成のページへ遷移します。
- タイプ ：シナリオのタイプがアイコンで表示されます。
    - アラート：赤いアイコンで表示されます。
    - インスタントルックアップ：青いアイコンで表示されます。
    - 定期実行：緑のアイコンで表示されます。
    - 未設定：灰色のアイコンで表示されます。
- シナリオ：シナリオ名が表示されます。シナリオ名の直下に表示される文字列はシナリオIDです。マウスオーバーし、クリックすることで、シナリオIDをコピーすることができます。
- トリガー：該当のシナリオに設定されたトリガー（サービス）がアイコンで表示されます。
- ルックアップ：ルックアップが設定されていると、アイコンが表示されます。マウスオーバーするとルックアップ対象のサービス名が表示されます。
- 次回の予定：定期実行で設定されているシナリオについて、次回のシナリオ実行日時が表示されます。
- 最後にトリガーされた日時：最後に対象のシナリオが発動した日時が表示されます。
- 最終更新日時：シナリオの設定が最後に更新された日時が表示されます。
- シナリオを管理：シナリオの編集ページへ遷移します。
- シナリオをクローンする：シナリオのコピーを作成します。クローンされたシナリオはシナリオ名に「Copy」という文字列が付与されます。
- 履歴を見る：シナリオが実行された履歴（アクティビティログ）を確認することができます。
    - 実行日時：シナリオが実行された日時が表示されます。
    - イベント：シナリオがトリガーされたイベントが表示されます。
    - シナリオ：実行されたシナリオ名が表示されます。
- シナリオを削除する：シナリオを削除します。一度削除されたシナリオは復元するこができません。
## シナリオの新規作成
「シナリオの新規作成」ボタンをクリックすると、モーダル画面が表示されます。下記の３つの項目を入力して保存ボタンを押してください。全て入力必須項目となります。
- シナリオタイトル：シナリオに任意の名前つけます。
- 概要：シナリオの概要を入力します。シナリオの概要は１０文字以上を必ず入力してください。
- シナリオタイプ：3種類のタイプ（アラート、インスタントルックアップ、定期実行）から、１つ選択します。
    - アラート：アラートを起因とするサイトやツールの分析をします。
    - インスタントルックアップ：ブラウザーの拡張機能を利用し、オンデマンドでサイトやツールの分析をします。
    - 定期実行：定期的にサイトやツールの分析をします。
##　シナリオフローチャート
シナリオの新規作成を保存すると、無地のキャンバスが表示されます。
下記に記述されている要素を設定してください。
### アラートシナリオ
- トリガー：「トリガーを設定」ボタンをクリックし、シナリオが発動するトリガー（きっかけ）を定義します。
    - タイトル：任意のトリガータイトルを入力します。
    - タイプ：監視システムからのアラートに対して動的相関が必要な場合は、「アラート」 を選択します。ブラウザのキーワードに基づく検索には、"インスタントルックアップ "を選択してください。
    - サービスのソースを選択：アラート送信元のサービスを選択します。
    - Alert Body：トリガーとなるサービスを選択すると、アラートボディのサンプルが表示されます。
    - カスタムキー：
    - カスタムキーの追加：カスタムキーを追加します。
        - 1.- Configure
            - Key Name：カスタムキーに名前を付けます。全てのカスタムキーの名前には「pw_custom_」という文字列が接頭語として追加されます。
            - Select what to parse：解析するペイロードを保持するアラートボディキーを選択します（デフォルトではすべてのアラートボディが使用されます）
            - Add samples for regex inference：サンプルペイロードを貼り付け、カスタムキーに対応する値を選択し、「infer regex from selection」をクリックします。
                - Paste sample payload：サンプルペイロードを貼り付けてください。
                - Extract selected value：ボタンをクリックすると、Target Valueに値が表示されます。
                - Target value：ターゲットとなる値が表示されます。
                - Prefix：該当する場合、一意性のために推測されたPrefixが表示されます。
                - Suffix：該当する場合、一意性のために推測されたSuffixが表示されます。
                - Add sample：サンプルペイロードを追加します。
            - Infer regex from samples：登録されたペイロードから正規表現パターンを作成します。手動で入力することも可能です。
        - 2.-Validate
            - Add samples for regex testing：作成した正規表現を検証します。
                - Paste sample payload：サンプルのペイロードを入力します。
                - Extract selected value：ボタンをクリックして、ターゲットとなる値を抜き出します。
                - Target Value：ターゲットとなる値が表示されます。
                - Add sample：サンプルを追加します。
            - Test regex extraction：正規表現による抽出可否を検証します。
            - Result：正規表現を適用してテストペイロードから抽出された値を表示します。
- ルックアップ：「ルックアップの新規作成」をクリックして、イベント発生時・解析時に、確認および解析の対象情報を設定します。シナリオの主要な部分です。下記の項目を登録して、保存ボタンをクリックします。
    - 設定
        - メソッドを設定：？？
        - タイトル：任意のタイトルを入力します。
        - ルックアップグループ：ルックアップグループを選択します。
        - URL：データ (ダッシュボード、ビュー、コンソールなど) の URL を入力します。
        - 自動検出されたサービス：PITWALL は、ユーザーの拡張機能またはコミュニティで共有されている拡張機能を使用して、Web サイトまたはツールを自動的に識別します。
        - 接続元（ソース）：トリガー名が表示されます。
    - スクリーンショット：シナリオが実行された際に、スクリーンショットを取得要否を設定します。
- 通知先：「通知先の管理」をクリックし、ルックアップされた情報を通知する先を設定します。Pitwallに登録されている通知先を設定する場合は、入力欄から通知先を検索して選択します。通知先を新規登録して設定したい場合は、名前と通知先を登録して設定します。通知先は複数設定が可能です。通知先として、E-mail、Slack、Teamsを設定が可能です。詳しくは「通知先の設定」マニュアルを参照してください。
- シナリオ設定の管理：キャンバス中央の歯車マークをクリックすると、「シナリオ設定の管理」というモーダルページがひょじされます。表示されたモーダル画面で、シナリオタイトルと概要を編集します。
### インスタントルックアップシナリオ
e

### 定期実行シナリオ





